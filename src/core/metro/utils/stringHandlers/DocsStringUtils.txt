# **DocumentaciÃ³n de Utils de MetroCore**  

## **ğŸ“Œ VisiÃ³n General**  
El mÃ³dulo `stringHandlers` contiene herramientas esenciales para:  
âœ… **NormalizaciÃ³n** de datos (estaciones, lÃ­neas)  
âœ… **DecoraciÃ³n** con emojis (Discord-friendly)  
âœ… **ValidaciÃ³n** de entradas  
âœ… **Formateo** de nombres y cÃ³digos  

---

## **ğŸ“‚ Estructura de Archivos**  
```
modules/metro/utils/stringHandlers
â”œâ”€â”€ decorators.js       # Emojis y formato visual
â”œâ”€â”€ lineProcessing.js   # Manejo de cÃ³digos de lÃ­nea
â”œâ”€â”€ stationFormatting.js # Formateo de nombres de estaciÃ³n
â”œâ”€â”€ validators.js       # ValidaciÃ³n de datos
â””â”€â”€ normalization.js    # NormalizaciÃ³n de texto
```

---

## **ğŸ”§ lineProcessing.js**  
**Funciones para procesar cÃ³digos de lÃ­neas del metro.**  

### **MÃ©todos Disponibles**  
| MÃ©todo | DescripciÃ³n | Ejemplo |  
|--------|-------------|---------|  
| `normalizeKey(lineCode)` | Estandariza cÃ³digos (`"1"` â†’ `"l1"`) | `normalizeKey("L2") â†’ "l2"` |  
| `formatDisplay(lineCode)` | Formato amigable (`"l1"` â†’ `"LÃ­nea 1"`) | `formatDisplay("4a") â†’ "LÃ­nea 4A"` |  
| `extractNumber(input)` | Extrae nÃºmero de lÃ­nea (`"L1"` â†’ `"1"`) | `extractNumber("LÃ­nea 2") â†’ "2"` |  

**Uso:**  
```js
const { normalizeKey } = require('./lineProcessing');
const lineKey = normalizeKey(userInput); // "l1"
```

---

## **ğŸ·ï¸ stationFormatting.js**  
**Formateo de nombres de estaciones.**  

### **MÃ©todos Disponibles**  
| MÃ©todo | DescripciÃ³n | Ejemplo |  
|--------|-------------|---------|  
| `formatName(stationName)` | Capitaliza correctamente | `formatName("estaciÃ³n los hÃ©roes") â†’ "Los Heroes"` |  
| `removeLineSuffix(stationName)` | Elimina sufijos (`"Baquedano L1"` â†’ `"Baquedano"`) | `removeLineSuffix("Puente Cal y Canto L2") â†’ "Puente Cal y Canto"` |  
| `generateId(stationName, lineCode)` | Crea ID Ãºnico (`"Los Heroes-l1"`) | `generateId("Los Heroes", "L1") â†’ "losheroes-l1"` |  

**Uso:**  
```js
const { formatName } = require('./stationFormatting');
const cleanName = formatName(rawStationName);
```

---

## **ğŸ¨ decorators.js**  
**Decora elementos con emojis para Discord.**  

### **MÃ©todos Disponibles**  
| MÃ©todo | DescripciÃ³n | Ejemplo |  
|--------|-------------|---------|  
| `decorateStation(name, options)` | AÃ±ade emojis de estado/lÃ­nea | `decorateStation("Baquedano", { line: "L1", status: "1" })` â†’ `"ğŸŸ© <:Linea1:123> Baquedano"` |  
| `decorateLine(lineCode)` | Devuelve emoji de lÃ­nea | `decorateLine("L5")` â†’ `<:Linea5:456>` |  
| `getConnectionEmoji(type)` | Emoji para conexiones (`"Centropuerto"` â†’ `"ğŸšŒ"`) | `getConnectionEmoji("BiciMetro")` â†’ `<:bicimetro:789>` |  

**Ejemplo en Discord:**  
```js
const { decorateStation } = require('./decorators');
const message = decorateStation("Los HÃ©roes", { 
    line: "L1", 
    status: "1", 
    transfer: true 
});
// â†’ "ğŸŸ© <:Linea1:123> Los HÃ©roes â†”ï¸"
```

---

## **ğŸ›¡ï¸ validators.js**  
**ValidaciÃ³n de datos de entrada.**  

### **MÃ©todos Disponibles**  
| MÃ©todo | DescripciÃ³n | Ejemplo |  
|--------|-------------|---------|  
| `isValidLine(lineCode)` | Verifica si una lÃ­nea existe | `isValidLine("L7") â†’ false` |  
| `isTransferStation(stationName, line)` | Comprueba si es estaciÃ³n de combinaciÃ³n | `isTransferStation("Baquedano", "L1") â†’ true` |  

**Uso:**  
```js
const { isValidLine } = require('./validators');
if (!isValidLine(userInput)) {
    reply("âŒ LÃ­nea no vÃ¡lida");
}
```

---

## **ğŸ”  normalization.js**  
**NormalizaciÃ³n de texto para bÃºsquedas.**  

### **MÃ©todos Disponibles**  
| MÃ©todo | DescripciÃ³n | Ejemplo |  
|--------|-------------|---------|  
| `normalize(text)` | Elimina acentos y sÃ­mbolos | `normalize("MÃ¡quina VerÃ¡") â†’ "maquina vera"` |  
| `sanitize(input)` | Limpia texto peligroso | `sanitize("<script>Hola</script>") â†’ "Hola"` |  
| `isMetroRelated(text)` | Detecta si el texto menciona el metro | `isMetroRelated("Â¿DÃ³nde estÃ¡ la estaciÃ³n?") â†’ true` |  

**Uso:**  
```js
const { normalize } = require('./normalization');
const searchTerm = normalize(userInput); // Para bÃºsquedas
```

---

## **ğŸ“Œ Ejemplo de Uso Combinado**  

```js
const { normalizeKey } = require('./lineProcessing');
const { formatName } = require('./stationFormatting');
const { decorateStation } = require('./decorators');
const { isValidLine } = require('./validators');

function showStationInfo(rawName, lineCode) {
    if (!isValidLine(lineCode)) {
        return "âŒ LÃ­nea no vÃ¡lida";
    }

    const cleanName = formatName(rawName);
    const lineKey = normalizeKey(lineCode);
    return decorateStation(cleanName, { 
        line: lineKey,
        status: "1" 
    });
}

// Output: "ğŸŸ© <:Linea1:123> Los Heroes"
console.log(showStationInfo("estaciÃ³n LOS HÃ‰ROES", "L1"));
```

---

## **âš™ï¸ IntegraciÃ³n con MetroCore**  
Los utils se usan internamente en `MetroCore` para:  
- Formatear nombres de estaciones en `getStation()`  
- Normalizar bÃºsquedas en `searchStations()`  
- Decorar mensajes en handlers de Discord  

```js
// Dentro de MetroCore.js
const station = {
    name: this.utils.formatName(rawName),
    line: this.utils.normalizeKey(lineCode),
    display: this.utils.decorate.decorateStation(rawName, { line: lineCode })
};
```

---

## **ğŸ“Œ Notas Clave**  
1. **Consistencia**: Todos los mÃ©todos manejan `null`/`undefined` de forma segura.  
2. **Eficiencia**: Las operaciones estÃ¡n optimizadas para alto rendimiento.  
3. **Discord**: Los decorators usan formatos compatibles con Discord (emojis personalizados).  

---

Esta documentaciÃ³n cubre todas las utilidades esenciales para el manejo de datos en el sistema MetroCore. ğŸš‡